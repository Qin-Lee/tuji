# 途迹 TravelPath

一个旅游攻略网站项目，主要功能是根据用户位置推荐旅游信息。

## 项目背景

做这个项目的时候，想的是做一个能根据地理位置推送合适旅游攻略的网站。用户可以直接获取位置，也可以手动输入位置。系统会根据位置推送周边景点、天气情况、穿衣建议，还有旅行计划。用户还能在网站上分享自己的旅行经历，订阅旅游资讯。

## 主要功能

### 定位和搜索

网站支持两种方式获取位置：自动定位和手动输入。自动定位用的是浏览器的地理位置API，手动输入就是直接搜索城市名称。输入城市后，系统会调用高德地图API获取天气和位置信息。

### 天气显示

集成了高德地图的天气API，可以显示当前天气和未来几天的预报。高德API只返回4天的数据，所以显示的是"未来天气预报"而不是"未来5天"。根据天气情况，系统还会给出穿衣建议，比如天气冷的话会建议穿厚外套、毛衣这些。

### 景点推荐

景点推荐这部分最开始是写死的，只有几个城市有数据。后来发现这样不够灵活，用户搜索其他城市就显示不出来。所以集成了Spark AI API，现在可以动态生成任何城市的景点推荐。景点卡片去掉了图片，改用emoji图标，这样加载更快，也不会出现图片不匹配的问题。

### 旅行计划

旅行计划也是用AI生成的，会根据城市特点生成详细的行程安排，包括景点路线、美食推荐、住宿建议和交通指南。这部分数据也是动态生成的，不需要手动维护。

### 游记分享

用户可以发表游记，包括昵称、目的地、评分和感想。目的地选择用的是自定义下拉框，样式和网站整体风格一致。游记会保存到本地存储，刷新页面后还能看到。

### 订阅功能

用户可以订阅旅游资讯，包括天气预警、旅游攻略、优惠信息和目的地推荐。这部分主要是前端展示，实际推送功能需要后端支持。

## 技术实现

### 前端

前端用的是原生HTML、CSS和JavaScript，没有用框架。这样项目更轻量，也更容易理解。

CSS用了CSS变量来管理颜色，方便统一修改主题。自定义光标效果是用JavaScript实现的，有两个层，一个点和一个圆圈，会跟随鼠标移动。

轮播图是自己写的，没有用第三方库。景点卡片用Grid布局，响应式设计，在不同屏幕尺寸下会自动调整。

### API集成

高德地图API用于获取天气和位置信息。API调用需要密钥，密钥配置在js/app.js的CONFIG对象里。

Spark AI API用于生成景点推荐和旅行计划。因为浏览器直接调用会有跨域问题，所以写了一个PHP代理文件api/ai.php来处理请求。PHP文件会生成HMAC签名，然后转发请求到AI API。

### 数据存储

游记数据保存在浏览器的localStorage里，这样用户刷新页面后数据还在。天气和景点数据是实时从API获取的，不保存。

## 项目结构

```
travel-guide/
├── index.html         主页面
├── css/
│   └── style.css      样式文件
├── js/
│   └── app.js         主要逻辑代码
├── api/
│   └── ai.php         AI API代理
├── images/            图片资源
├── assets/            其他资源
├── .gitignore         Git忽略文件
└── README.md          项目说明
```

## 部署说明

项目需要部署到Web服务器上，比如Apache。PHP文件需要PHP环境支持。

部署步骤：

1. 把项目文件复制到Web服务器目录，比如 /var/www/html/travel-guide/

2. 配置API密钥，编辑 js/app.js 文件，找到CONFIG对象，填入高德地图API密钥

3. 如果需要使用AI功能，还需要配置Spark AI的密钥，在api/ai.php文件里

4. 访问 http://服务器地址/travel-guide/ 就能看到网站了

## 遇到的问题和解决

### 天气API只返回4天数据

最开始标题写的是"未来5天天气预报"，但高德API只返回4天。后来改成"未来天气预报"，更准确。

### 景点图片不匹配

最开始景点卡片用的是Unsplash的图片，但经常出现图片和景点不匹配的情况，比如颐和园显示的是欧洲城堡。后来干脆去掉图片，改用emoji图标，这样更简洁，也不会出错。

### AI API跨域问题

Spark AI API需要HMAC签名认证，而且浏览器直接调用会有跨域限制。所以写了一个PHP代理文件来处理，PHP在服务器端调用API，然后返回结果给前端。

### 下拉框样式不统一

原生的select下拉框样式很难自定义，和网站整体风格不搭。所以自己写了一个自定义下拉组件，用div和JavaScript实现，样式完全可控。

## 后续改进方向

1. 游记功能可以加上后端，实现真正的数据持久化
2. 订阅功能需要后端支持，才能实现真正的推送
3. 可以加上用户登录功能，保存用户的搜索历史
4. 景点推荐可以加上图片，但需要确保图片和景点匹配
5. 可以加上地图功能，在地图上显示景点位置

## 技术栈

- HTML5
- CSS3 (CSS变量、Grid、Flexbox)
- JavaScript (ES6+)
- PHP (API代理)
- 高德地图API
- Spark AI API

## 参考资源

- 高德开放平台: https://lbs.amap.com/
- Spark AI: https://www.xfyun.cn/
- Google Fonts: https://fonts.google.com/

## 许可证

MIT License

